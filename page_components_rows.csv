id,component_name,display_name_en,display_name_he,html_structure,css_styles,javascript_code,panel_location,display_order,width_setting,height_setting,is_active,requires_supabase,depends_on,version,description,author,tags,created_at,updated_at,last_deployed
3,smart-search-module,Smart Search,×—×™×¤×•×© ×—×›×,"<!-- Separator Line -->
<div class=""border-t-4 border-gray-300 my-2""></div>

<!-- Voice Search Header -->
<div class=""p-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white"">
    <h3 class=""font-bold text-sm text-center"">ğŸ¤ ×—×™×¤×•×© ×—×›×</h3>
    <p class=""text-xs text-center opacity-90 mt-1"">×—×™×¤×•×© × ×•×¡×£ ×‘××™×“×ª ×”×¦×•×¨×š</p>
</div>

<!-- Voice + Text Search Input -->
<div class=""p-3 bg-white border-b-2 border-gray-200"">
    <div class=""relative"">
        <input 
            type=""text"" 
            id=""smartSearchInput""
            placeholder=""ğŸ” ×”×§×œ×“ ××• ×œ×—×¥ ×¢×œ ×”××™×§×¨×•×¤×•×Ÿ...""
            class=""w-full p-3 pr-12 border-2 border-purple-400 rounded-lg text-right text-sm focus:outline-none focus:border-purple-600 transition-all""
            dir=""rtl""
            onkeypress=""if(event.key==='Enter') searchSmartInput()""
        >
        <!-- Voice Button -->
        <button 
            id=""voiceSearchBtn""
            onclick=""toggleVoiceSearch()""
            class=""absolute left-2 top-2 w-10 h-10 bg-purple-500 hover:bg-purple-600 rounded-lg flex items-center justify-center transition-all""
            title=""×œ×—×¥ ×œ×”×§×œ×˜×” ×§×•×œ×™×ª"">
            <svg class=""w-5 h-5 text-white"" fill=""none"" stroke=""currentColor"" viewBox=""0 0 24 24"">
                <path stroke-linecap=""round"" stroke-linejoin=""round"" stroke-width=""2"" d=""M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z""></path>
            </svg>
        </button>
    </div>
    <!-- Voice Status Message -->
    <div id=""voiceStatus"" class=""text-xs text-center mt-2 h-4 text-gray-500""></div>
</div>

<!-- Popular Keywords -->
<div class=""p-3 bg-gradient-to-br from-blue-50 to-purple-50 border-b-2 border-gray-200"">
    <div class=""text-xs font-bold text-gray-600 mb-2 text-center"">ğŸ’¡ ××™×œ×•×ª ××¤×ª×—</div>
    <div class=""flex flex-wrap gap-2 justify-center"">
        <span onclick=""searchKeyword('×›××‘')"" class=""px-3 py-1 bg-white border-2 border-blue-300 text-blue-700 rounded-full text-xs font-bold cursor-pointer hover:bg-blue-100 transition-all"">×›××‘</span>
        <span onclick=""searchKeyword('×—×¨×“×”')"" class=""px-3 py-1 bg-white border-2 border-purple-300 text-purple-700 rounded-full text-xs font-bold cursor-pointer hover:bg-purple-100 transition-all"">×—×¨×“×”</span>
        <span onclick=""searchKeyword('×¢×™×™×¤×•×ª')"" class=""px-3 py-1 bg-white border-2 border-green-300 text-green-700 rounded-full text-xs font-bold cursor-pointer hover:bg-green-100 transition-all"">×¢×™×™×¤×•×ª</span>
        <span onclick=""searchKeyword('×©×™× ×”')"" class=""px-3 py-1 bg-white border-2 border-indigo-300 text-indigo-700 rounded-full text-xs font-bold cursor-pointer hover:bg-indigo-100 transition-all"">×©×™× ×”</span>
        <span onclick=""searchKeyword('×¢×™×›×•×œ')"" class=""px-3 py-1 bg-white border-2 border-orange-300 text-orange-700 rounded-full text-xs font-bold cursor-pointer hover:bg-orange-100 transition-all"">×¢×™×›×•×œ</span>
        <span onclick=""searchKeyword('×¢×•×¨')"" class=""px-3 py-1 bg-white border-2 border-pink-300 text-pink-700 rounded-full text-xs font-bold cursor-pointer hover:bg-pink-100 transition-all"">×¢×•×¨</span>
    </div>
</div>

<!-- Alphabet Navigation -->
<div class=""p-3 bg-gradient-to-br from-purple-50 to-pink-50 border-b-2 border-gray-200"">
    <div class=""text-xs font-bold text-gray-600 mb-2 text-center"">ğŸ”¤ ×§×¤×•×¥ ×œ××•×ª</div>
    <div class=""flex flex-wrap gap-1 justify-center"" id=""alphabetNav"">
        <!-- Hebrew alphabet buttons generated by JavaScript -->
    </div>
</div>","/* Microphone button listening state */
#voiceSearchBtn.listening {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%) !important;
    animation: listening-pulse 1s infinite;
}

@keyframes listening-pulse {
    0%, 100% { 
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
    }
    50% { 
        transform: scale(1.05);
        box-shadow: 0 0 0 10px rgba(239, 68, 68, 0);
    }
}

/* Input field listening state */
#smartSearchInput.listening {
    border-color: #ef4444 !important;
    animation: pulse-border 1.5s infinite;
}

@keyframes pulse-border {
    0%, 100% { 
        border-color: #ef4444;
    }
    50% { 
        border-color: #fca5a5;
    }
}",,left-panel,3,,,true,false,,1.0,,,,2026-02-02 03:23:24.947134+00,2026-02-05 13:00:41.753185+00,
4,body-figures-display-system,Body Figures Display,×ª×¦×•×’×ª ××™×•×¨×™ ×’×•×£,"<div id=""bodyFiguresDisplay"" style=""display: none; margin-top: 20px; padding: 20px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 12px; border: 2px solid #0ea5e9;"">
    <div style=""text-align: center; margin-bottom: 20px;"">
        <h3 style=""color: #0369a1; font-size: 18px; font-weight: bold; margin-bottom: 8px;"">ğŸ“ ××™×§×•× × ×§×•×“×•×ª ×”×“×™×§×•×¨</h3>
        <p style=""color: #64748b; font-size: 14px;"">×ª××•× ×•×ª ×’×•×£ ×¢× × ×§×•×“×•×ª ××•×“×’×©×•×ª - ×”×™×›×Ÿ ×œ××§× ××ª ×”××—×˜×™×</p>
    </div>
    <div id=""bodyImagesGrid"" style=""display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;""></div>
    <div id=""bodyFiguresNoResults"" style=""display: none; text-align: center; padding: 40px; color: #64748b;"">
        <p style=""font-size: 16px;"">××™×Ÿ × ×§×•×“×•×ª ×“×™×§×•×¨ ×œ×”×¦×’×”</p>
    </div>
</div>",".body-figure-card { background: white; border-radius: 12px; padding: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); border: 2px solid #e2e8f0; transition: all 0.3s ease; }
.body-figure-card:hover { box-shadow: 0 10px 15px rgba(0, 0, 0, 0.15); border-color: #0ea5e9; transform: translateY(-2px); }
.body-part-title { text-align: center; color: #0369a1; font-size: 16px; font-weight: bold; margin-bottom: 12px; padding-bottom: 8px; border-bottom: 2px solid #e0f2fe; }
.body-image-container { position: relative; width: 100%; max-width: 400px; margin: 0 auto; border-radius: 8px; overflow: hidden; background: #f8fafc; }
.body-image-container img { width: 100%; height: auto; display: block; }
.acupoint-dot { position: absolute; width: 16px; height: 16px; background: #ef4444; border: 3px solid white; border-radius: 50%; box-shadow: 0 2px 8px rgba(239, 68, 68, 0.6); cursor: pointer; transition: all 0.2s ease; z-index: 10; animation: pulse-dot 2s infinite; }
.acupoint-dot:hover { transform: scale(1.3); background: #dc2626; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.8); }
@keyframes pulse-dot { 0%, 100% { box-shadow: 0 2px 8px rgba(239, 68, 68, 0.6); } 50% { box-shadow: 0 2px 16px rgba(239, 68, 68, 0.9), 0 0 0 8px rgba(239, 68, 68, 0.2); } }
.acupoint-label { position: absolute; background: rgba(0, 0, 0, 0.85); color: white; padding: 6px 10px; border-radius: 6px; font-size: 12px; font-weight: bold; white-space: nowrap; pointer-events: none; z-index: 20; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); }
.points-list { margin-top: 16px; padding: 12px; background: #f1f5f9; border-radius: 8px; }
.points-list-title { color: #475569; font-size: 13px; font-weight: bold; margin-bottom: 8px; }
.point-item { display: inline-block; background: white; padding: 6px 12px; margin: 4px; border-radius: 6px; border: 1px solid #cbd5e1; font-size: 12px; color: #1e293b; font-weight: 600; }","(async function initBodyFiguresDisplay() {
    console.log(""ğŸ¯ Loading Body Figures Display System..."");
    
    function extractAcupointCodes(text) {
        if (!text) return [];
        const pattern = /\b([A-Z]{2,4}\d{1,3})\b/g;
        const matches = text.match(pattern);
        if (!matches) return [];
        return [...new Set(matches)];
    }
    
    async function getBodyImages(acupointCodes) {
        if (!acupointCodes || acupointCodes.length === 0) return [];
        try {
            console.log(""ğŸ” Querying body images for codes:"", acupointCodes);
            const { data, error } = await supabaseClient.rpc(""get_body_images_for_acupoints"", {
                p_acupoint_codes: acupointCodes
            });
            if (error) throw error;
            console.log(""âœ… Body images received:"", data);
            return data || [];
        } catch (error) {
            console.error(""âŒ Error fetching body images:"", error);
            return [];
        }
    }
    
    function displayBodyFigures(bodyImagesData) {
        const container = document.getElementById(""bodyFiguresDisplay"");
        const grid = document.getElementById(""bodyImagesGrid"");
        const noResults = document.getElementById(""bodyFiguresNoResults"");
        if (!container || !grid) {
            console.error(""âŒ Body figures container not found!"");
            return;
        }
        grid.innerHTML = """";
        if (!bodyImagesData || bodyImagesData.length === 0) {
            container.style.display = ""none"";
            return;
        }
        container.style.display = ""block"";
        noResults.style.display = ""none"";
        bodyImagesData.forEach(bodyImage => {
            const card = createBodyFigureCard(bodyImage);
            grid.appendChild(card);
        });
        console.log(""âœ… Displayed"", bodyImagesData.length, ""body images"");
    }
    
    function createBodyFigureCard(bodyImage) {
        const card = document.createElement(""div"");
        card.className = ""body-figure-card"";
        const title = document.createElement(""div"");
        title.className = ""body-part-title"";
        title.textContent = bodyImage.body_part_he || bodyImage.body_part_en || bodyImage.body_part;
        card.appendChild(title);
        const imageContainer = document.createElement(""div"");
        imageContainer.className = ""body-image-container"";
        const img = document.createElement(""img"");
        img.src = bodyImage.image_url;
        img.alt = bodyImage.body_part;
        img.style.width = ""100%"";
        img.style.height = ""auto"";
        imageContainer.appendChild(img);
        if (bodyImage.matched_points) {
            Object.entries(bodyImage.matched_points).forEach(([code, point]) => {
                const dot = createAcupointDot(code, point);
                imageContainer.appendChild(dot);
            });
        }
        card.appendChild(imageContainer);
        if (bodyImage.matched_points) {
            const pointsList = createPointsList(bodyImage.matched_points);
            card.appendChild(pointsList);
        }
        return card;
    }
    
    function createAcupointDot(code, point) {
        const dot = document.createElement(""div"");
        dot.className = ""acupoint-dot"";
        dot.style.left = point.x + ""px"";
        dot.style.top = point.y + ""px"";
        dot.style.marginLeft = ""-8px"";
        dot.style.marginTop = ""-8px"";
        const label = document.createElement(""div"");
        label.className = ""acupoint-label"";
        label.textContent = code + "" - "" + (point.name || """");
        label.style.left = (point.x + 20) + ""px"";
        label.style.top = (point.y - 10) + ""px"";
        label.style.display = ""none"";
        dot.addEventListener(""mouseenter"", () => { label.style.display = ""block""; });
        dot.addEventListener(""mouseleave"", () => { label.style.display = ""none""; });
        dot.appendChild(label);
        return dot;
    }
    
    function createPointsList(matchedPoints) {
        const container = document.createElement(""div"");
        container.className = ""points-list"";
        const title = document.createElement(""div"");
        title.className = ""points-list-title"";
        title.textContent = ""× ×§×•×“×•×ª ××•×¦×’×•×ª:"";
        container.appendChild(title);
        Object.entries(matchedPoints).forEach(([code, point]) => {
            const item = document.createElement(""span"");
            item.className = ""point-item"";
            item.textContent = code;
            item.title = point.name || code;
            container.appendChild(item);
        });
        return container;
    }
    
    window.displayBodyFiguresForResponse = async function(apiResponseText) {
        console.log(""ğŸ¯ Processing API response for body figures..."");
        const codes = extractAcupointCodes(apiResponseText);
        if (codes.length === 0) {
            console.log(""â„¹ï¸ No acupoint codes found in response"");
            document.getElementById(""bodyFiguresDisplay"").style.display = ""none"";
            return;
        }
        console.log(""âœ… Found acupoint codes:"", codes);
        const bodyImages = await getBodyImages(codes);
        displayBodyFigures(bodyImages);
    };
    
    window.hideBodyFigures = function() {
        const container = document.getElementById(""bodyFiguresDisplay"");
        if (container) container.style.display = ""none"";
    };
    
    console.log(""âœ… Body Figures Display System Loaded!"");
})();",api-results,1,,,true,false,,1.0,,,,2026-02-02 05:14:17.471901+00,2026-02-02 05:14:17.471901+00,